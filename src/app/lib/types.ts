// src/app/lib/types.ts

// 公文类型接口定义
export interface DocumentType {
  id: string;
  name: string;
  icon: string;
  description: string;
  templatePrompt: string;
  category: 'standard' | 'professional' | 'speech' | 'official'; // 分类
}

// 添加WritingRequest接口定义
export interface WritingRequest {
  prompt: string;
  style?: PromptStyle;
  apiKey?: string;
  apiProvider?: 'openai' | 'openrouter' | 'custom';
  apiEndpoint?: string;
  model?: string;
  temperature?: number;
  maxTokens?: number;
  keywords?: string[];
}

// 添加ApiResponse接口定义
export interface ApiResponse {
  content: string;
  error?: string;
}

// 添加PromptStyle接口定义
export interface PromptStyle {
  name?: string;
  description?: string;
  style_summary?: string;
  language?: {
    sentence_pattern?: string[];
    word_choice?: {
      formality_level?: number;
      [key: string]: unknown;
    };
    [key: string]: unknown;
  };
  [key: string]: unknown;
}

// 文档上下文接口
export interface DocumentContext {
  subject: string;
  recipients: string;
  keywords: string[];
  specialRequirements: string;
  referenceFiles: File[];
  background: string;  // 添加背景信息字段
}

// 风格偏好设置
export interface StylePreference {
  formalityLevel: number;    // 正式程度 (1-5)
  toneStyle: string;         // 风格体系
  detailLevel: number;       // 详细程度 (1-5)
  structurePreference: string; // 结构偏好
}

// 预定义公文类型 - 按分类组织
export const DOCUMENT_TYPES: DocumentType[] = [
  // 标准公文类型
  {
    id: 'report',
    name: '工作报告',
    icon: '📊',
    description: '总结过去工作情况、分析存在问题、提出下一步工作计划或建议的报告类文件',
    templatePrompt: `请根据提供的信息撰写一份规范的工作报告。

一、标题要求
标题应为"发文单位+关于+事由+的报告"格式，居中排布，不使用标点符号。

二、正文结构
1. 开头部分：简要说明报告目的和背景，可使用"现将...情况报告如下"等过渡语。
2. 主体部分：
   （一）工作基本情况：客观陈述工作开展情况，使用准确数据和具体事例。
   （二）主要成效：分条列举工作取得的成绩，突出重点成果和亮点。
   （三）问题分析：实事求是分析存在的困难和问题，提出原因。
   （四）下一步工作计划：明确工作目标、具体措施和时间节点。
3. 结尾部分：使用"以上报告，请审阅"等规范用语结束。

三、语言要求
1. 使用规范公文用语，如"认真贯彻""扎实推进""切实加强"等。
2. 数据表述精确，避免模糊表达如"大约""左右"等词语。
3. 时态一致，多用现在完成时描述已完成工作。

四、格式规范
1. 正文段落首行缩进2字符（包括一级标题）。
2. 一级标题使用"一、二、"等序号，二级标题使用"（一）（二）"等序号。
3. 落款右对齐，包括单位名称和日期（XXXX年XX月XX日）。
4. 落款下方注明联系人和联系方式，格式为"联系人：XXX，联系电话：XXXXXXXX"。

请确保报告内容客观真实，语言严谨规范，结构层次清晰。`,
    category: 'standard'
  },
  {
    id: 'notice',
    name: '通知',
    icon: '📢',
    description: '传达政策规定、工作安排或活动组织等事项的文件',
    templatePrompt: `请根据提供的信息撰写一份规范的通知。

一、标题要求
标题应为"发文单位+关于+事由+的通知"格式，居中排布，不使用标点符号。

二、正文结构
1. 主送机关：顶格写明接收单位，如"各区县人民政府，市直各部门："。
2. 开头部分：
   - 说明发文依据，如"根据《上级文件》精神"或"为贯彻落实XX会议要求"。
   - 使用"现将...通知如下"等过渡语引出具体内容。
3. 主体部分：
   - 按重要性或时间顺序分条列出通知事项。
   - 每条内容应明确说明时间、地点、对象、要求等要素。
   - 使用"一、二、"等序号标识不同事项。
4. 结尾部分：
   - 明确责任单位和联系方式。
   - 必要时说明通知执行时限。
   - 使用"特此通知"等规范用语结束。

三、语言要求
1. 使用简洁明了的指令性语言，如"务必""应当""确保"等。
2. 时间、地点、人员等信息表述准确无误。
3. 避免使用模糊表达和口语化词汇。

四、格式规范
1. 正文段落首行缩进2字符（包括一级标题）。
2. 落款右对齐，包括单位名称和日期（XXXX年XX月XX日）。
3. 落款下方注明联系人和联系方式，格式为"联系人：XXX，联系电话：XXXXXXXX"。
4. 如有附件，在正文结束后注明。

请确保通知内容清晰明确，要求具体可行，便于接收单位理解和执行。`,
    category: 'standard'
  },
  {
    id: 'decision',
    name: '决定',
    icon: '⚖️',
    description: '对重要事项或重大行动作出安排，对已明确并需要遵循的规则、定论作出明确表述的法定公文',
    templatePrompt: `请根据提供的信息撰写一份规范的决定。

一、标题要求
标题应为"发文单位+关于+事由+的决定"格式，居中排布，不使用标点符号。

二、正文结构
1. 主送机关：顶格写明接收单位。
2. 开头部分：
   - 阐明作出决定的背景、依据和目的。
   - 可引用上级政策文件或法律法规作为依据。
   - 使用"经研究，决定如下"等过渡语引出具体内容。
3. 主体部分：
   - 分条列出决定事项，使用"一、二、"等序号。
   - 内容应包括决定的具体内容、实施范围、执行标准等。
   - 明确各相关单位职责分工和工作要求。
4. 结尾部分：
   - 说明决定的生效时间和有效期限。
   - 明确解释权归属。
   - 使用"特此决定"等规范用语结束。

三、语言要求
1. 使用权威性、指令性语言，如"必须""严禁""不得"等。
2. 表述严谨精确，避免歧义和模糊表达。
3. 条款之间逻辑关系清晰，前后一致。

四、格式规范
1. 正文段落首行缩进2字符（包括一级标题）。
2. 一级标题使用"一、二、"等序号，二级标题使用"（一）（二）"等序号。
3. 落款右对齐，包括单位名称和日期（XXXX年XX月XX日）。
4. 落款下方注明联系人和联系方式，格式为"联系人：XXX，联系电话：XXXXXXXX"。

请确保决定内容合法合规，表述严谨权威，便于执行和监督。`,
    category: 'standard'
  },
  {
    id: 'reply',
    name: '批复',
    icon: '✅',
    description: '对下级机关请示事项的答复性公文',
    templatePrompt: `请根据提供的信息撰写一份规范的批复。

一、标题要求
标题应为"发文单位+关于+请示事项+的批复"格式，居中排布，不使用标点符号。

二、正文结构
1. 主送机关：顶格写明请示单位，如"XX县人民政府："。
2. 开头部分：
   - 引述收到的请示文件，注明请示文号和标题。
   - 使用"收悉"或"已收悉"等词语表示接收。
   - 如"你单位《关于XX的请示》（X文〔20XX〕X号）收悉。"
3. 主体部分：
   - 明确表达批复意见，可使用"经研究，现批复如下："引出。
   - 分条列出具体批复内容，使用"一、二、"等序号。
   - 对请示的每个问题给予明确答复。
   - 必要时提出工作要求和注意事项。
4. 结尾部分：
   - 使用"此复"等规范用语结束。

三、语言要求
1. 使用简明扼要、准确规范的语言。
2. 批复意见表述明确，避免模棱两可。
3. 语气庄重，体现上下级关系。

四、格式规范
1. 正文段落首行缩进2字符（包括一级标题）。
2. 落款右对齐，包括单位名称和日期（XXXX年XX月XX日）。
3. 落款下方注明联系人和联系方式，格式为"联系人：XXX，联系电话：XXXXXXXX"。
4. 如有附件，在正文结束后注明。

请确保批复内容明确具体，有针对性地回应请示事项，便于下级单位执行。`,
    category: 'standard'
  },
  {
    id: 'request',
    name: '请示',
    icon: '🔍',
    description: '向上级机关请求指示或批准的公文',
    templatePrompt: `请根据提供的信息撰写一份规范的请示。

一、标题要求
标题应为"发文单位+关于+请示事项+的请示"格式，居中排布，不使用标点符号。

二、正文结构
1. 开头部分：
   - 简要说明请示的主要事项。
   - 可使用"现将XX事项请示如下"等过渡语。
2. 背景情况：
   - 说明提出请示的背景和原因。
   - 介绍相关工作的开展情况。
   - 引用相关政策法规或上级指示精神。
3. 具体请示事项：
   - 明确提出需要上级批准或指示的具体事项。
   - 请示事项应具体明确，一事一请。
   - 如有多项请示事项，可分条列出。
4. 理由和依据：
   - 说明提出请示事项的必要性和可行性。
   - 阐述请示事项的理由和依据。
   - 必要时可提出初步意见和建议。
5. 结尾部分：
   - 表达恳请批准或指示的意愿。
   - 可使用"请批准"、"请审批"等表述。

三、语言要求
1. 使用恳切、规范的公文语言。
2. 表述准确、简明，避免模糊不清的表达。
3. 语气恳切但不卑微，态度诚恳。

四、格式规范
1. 正文段落首行缩进2字符（包括一级标题）。
2. 请示只写一个上级机关，不得多头请示。
3. 落款右对齐，包括单位名称和日期（XXXX年XX月XX日）。
4. 落款下方注明联系人和联系方式，格式为"联系人：XXX，联系电话：XXXXXXXX"。
4. 如有附件，在正文结束后注明。

请确保请示内容清晰明确，事由充分，请求具体，便于上级机关理解和批复。`,
    category: 'standard'
  },
  {
    id: 'letter',
    name: '函',
    icon: '✉️',
    description: '用于不相隶属机关之间商洽工作、询问和答复问题、请求批准和答复审批事项的公文',
    templatePrompt: `请根据提供的信息撰写一份规范的函。

一、标题要求
标题应为"发文单位+关于+事由+的函"格式，居中排布，不使用标点符号。

二、正文结构
1. 主送机关：顶格写明接收单位，如"XX市教育局："。
2. 开头部分：
   - 如是对方来函的回复，应先引述对方来函的标题和文号，如"贵局《关于XX的函》（X文〔20XX〕X号）收悉。"
   - 如是主动发函，应开门见山说明发函目的。
3. 主体部分：
   - 详细说明函件内容，包括事由、具体事项、相关要求等。
   - 如有必要，可分条列出，使用"一、二、"等序号。
4. 结尾部分：
   - 表达合作意愿，如"望贵单位予以支持和配合"。
   - 提供联系方式，便于沟通协调。
   - 使用"此函"等规范用语结束。

三、语言要求
1. 使用礼貌、平等的语气，体现机关间的平行关系。
2. 表述客观、简洁、明确。
3. 避免使用命令性、指示性语言。

四、格式规范
1. 正文段落首行缩进2字符（包括一级标题）。
2. 落款右对齐，包括单位名称和日期（XXXX年XX月XX日）。
3. 落款下方注明联系人和联系方式，格式为"联系人：XXX，联系电话：XXXXXXXX"。
4. 如有附件，在正文结束后注明。

请确保函件内容清晰明确，语气平等友好，便于接收单位理解和配合。`,
    category: 'standard'
  },
  {
    id: 'minutes',
    name: '会议纪要',
    icon: '📝',
    description: '记录会议主要内容和议定事项的文件',
    templatePrompt: `请根据提供的信息撰写一份规范的会议纪要。

一、标题要求
标题应为"会议名称+纪要"格式，居中排布，不使用标点符号。

二、正文结构
1. 会议基本情况：
   - 会议时间：XXXX年XX月XX日，可注明具体时段。
   - 会议地点：详细会议场所。
   - 主持人：职务+姓名。
   - 参会人员：按照职务高低或单位顺序列出，可分类表述。
   - 会议议题：简要说明本次会议的主要议题。
2. 会议内容：
   - 按照发言先后或议题顺序记录会议主要内容。
   - 重点记录领导讲话和重要发言。
   - 客观记录各方意见，不加主观评价。
3. 会议议定事项：
   - 使用"经研究，会议决定："引出议定事项。
   - 分条列出会议形成的决议、决定或工作安排。
   - 明确责任单位、责任人和完成时限。

三、语言要求
1. 使用客观、准确的语言记录会议内容。
2. 人称表述统一，一般使用第三人称。
3. 直接引用发言时应使用引号，并注明发言人。

四、格式规范
1. 正文段落首行缩进2字符（包括一级标题）。
2. 一级标题使用"一、二、"等序号，二级标题使用"（一）（二）"等序号。
3. 落款可省略，或仅注明记录人和整理日期。
4. 如需注明联系人，格式为"联系人：XXX，联系电话：XXXXXXXX"。
5. 如需分发，可在文末注明分发范围。

请确保会议纪要内容客观真实，重点突出，议定事项明确具体，便于各单位执行落实。`,
    category: 'standard'
  },
  {
    id: 'announcement',
    name: '公告',
    icon: '📌',
    description: '向社会公开宣布重要事项或法定事项的公文',
    templatePrompt: `请根据提供的信息撰写一份规范的公告。

一、标题要求
标题应为"发文单位+公告"或"发文单位+关于+事由+的公告"格式，居中排布，不使用标点符号。

二、正文结构
1. 开头部分：
   - 说明发布公告的依据和目的。
   - 可引用相关法律法规或政策文件作为依据。
2. 主体部分：
   - 详细说明公告的具体内容，包括公告事项、适用范围、实施时间等。
   - 内容应条理清晰，可分条列出，使用"一、二、"等序号。
   - 如涉及公众权益，应明确说明相关权利和义务。
3. 结尾部分：
   - 说明公告的有效期限。
   - 提供咨询方式或联系电话。
   - 使用"特此公告"等规范用语结束。

三、语言要求
1. 使用庄重、权威的语气，体现政府公信力。
2. 表述准确、清晰，避免专业术语和难懂词汇。
3. 内容通俗易懂，便于公众理解。

四、格式规范
1. 正文段落首行缩进2字符（包括一级标题）。
2. 落款右对齐，包括单位名称和日期（XXXX年XX月XX日）。
3. 落款下方注明联系人和联系方式，格式为"联系人：XXX，联系电话：XXXXXXXX"。
4. 如有附件，在正文结束后注明。
5. 可加盖发文单位公章。

请确保公告内容准确无误，表述清晰明了，便于社会公众知晓和遵守。`,
    category: 'standard'
  },
  {
    id: 'circular',
    name: '通报',
    icon: '📃',
    description: '表彰先进、批评错误、传达重要精神或情况的公文',
    templatePrompt: `请根据以下信息撰写一份通报，包括标题、正文（说明通报的主要内容、具体情况、成绩或问题、表彰或批评意见等）和结尾。语言要求客观公正、实事求是。`,
    category: 'standard'
  },

  // 专业报告类型
  {
    id: 'summary',
    name: '总结',
    icon: '📝',
    description: '对某一时期、某项工作或某个问题的回顾与分析',
    templatePrompt: `请根据提供的信息撰写一份规范的总结。

一、标题要求
标题应为"XX年度/XX工作总结"或"关于XX工作的总结"格式，居中排布，不使用标点符号。

二、正文结构
1. 开篇概述：
   - 简要说明总结的时间范围、工作范围和总体情况。
   - 概括总结的主要内容和重点。
2. 工作回顾：
   - 客观回顾总结期内的主要工作和完成情况。
   - 可按照时间顺序或工作类别进行分类叙述。
   - 使用具体数据和事例支撑。
3. 成绩与经验：
   - 总结取得的主要成绩和成效。
   - 分析成绩背后的经验和做法。
   - 提炼工作中形成的规律性认识。
4. 问题与不足：
   - 实事求是地分析存在的问题和不足。
   - 深入剖析问题产生的原因。
   - 客观评价工作中的薄弱环节。
5. 今后打算：
   - 提出下一步工作思路和计划。
   - 明确改进措施和努力方向。
   - 表达做好工作的决心。

三、语言要求
1. 使用客观、实事求是的语言，避免过度评价。
2. 成绩不夸大，问题不回避，态度诚恳。
3. 表述简明扼要，重点突出。

四、格式规范
1. 正文段落首行缩进2字符（包括一级标题）。
2. 各级标题使用规范的序号标识。
3. 落款包括撰写单位/个人和日期。
4. 落款下方注明联系人和联系方式，格式为"联系人：XXX，联系电话：XXXXXXXX"。

请确保总结内容客观真实，既总结成绩又分析问题，既回顾过去又展望未来，体现工作的连续性和发展性。`,
    category: 'professional'
  },
  {
    id: 'plan',
    name: '工作计划',
    icon: '📅',
    description: '对未来一段时间工作进行规划安排的文件',
    templatePrompt: `请根据以下信息撰写一份工作计划，包括标题、正文（指导思想、总体目标、主要任务、具体措施、保障机制等）和结尾。语言要求明确、具体、可操作性强。`,
    category: 'professional'
  },
  {
    id: 'research',
    name: '调研报告',
    icon: '🔍',
    description: '对某一问题或现象进行调查研究后形成的报告',
    templatePrompt: `请根据提供的信息撰写一份规范的调研报告。

一、标题要求
标题应为"关于+调研对象/主题+的调研报告"格式，居中排布，不使用标点符号。

二、正文结构
1. 调研概况：
   - 说明调研的背景、目的和意义。
   - 介绍调研的时间、地点、对象和方法。
   - 简要说明调研的主要内容和过程。
2. 基本情况：
   - 客观描述调研对象的基本情况和现状。
   - 使用数据和事实支撑描述。
   - 可按照不同维度或方面进行分类叙述。
3. 主要发现：
   - 系统总结调研中发现的主要问题和特点。
   - 分析问题产生的原因和影响。
   - 可使用案例和数据进行说明。
4. 经验做法：
   - 总结调研中发现的好经验、好做法。
   - 分析经验做法的特点和推广价值。
5. 对策建议：
   - 针对发现的问题提出具体对策建议。
   - 建议应具有针对性、可行性和操作性。
   - 可分条列出，使用"一、二、"等序号。

三、语言要求
1. 使用客观、准确的语言，避免主观臆断。
2. 数据真实可靠，引用资料注明来源。
3. 分析深入，建议切实可行。

四、格式规范
1. 正文段落首行缩进2字符（包括一级标题）。
2. 各级标题使用规范的序号标识。
3. 图表、数据应清晰规范，并标注来源。
4. 落款包括调研单位和日期。
5. 落款下方注明联系人和联系方式，格式为"联系人：XXX，联系电话：XXXXXXXX"。

请确保报告内容客观真实，分析深入，建议具体可行，为决策提供参考依据。`,
    category: 'professional'
  },
  {
    id: 'feasibility',
    name: '可行性报告',
    icon: '📈',
    description: '对拟建项目或实施方案进行可行性分析的报告',
    templatePrompt: `请根据提供的信息撰写一份规范的可行性报告。

一、标题要求
标题应为"XX项目可行性研究报告"或"关于XX项目的可行性研究报告"格式，居中排布，不使用标点符号。

二、正文结构
1. 项目概述：
   - 简要介绍项目的基本情况、背景和目标。
   - 说明项目的规模、性质和主要内容。
2. 必要性分析：
   - 分析项目实施的政策依据。
   - 阐述项目的社会效益和经济效益。
   - 说明项目对解决现实问题的意义。
3. 可行性分析：
   - 技术可行性：分析项目的技术路线和技术条件。
   - 经济可行性：进行投资估算和效益分析，包括投资回收期、内部收益率等指标。
   - 管理可行性：分析组织管理条件和人力资源保障。
   - 社会可行性：分析项目的社会影响和环境影响。
4. 风险评估：
   - 识别项目可能面临的主要风险。
   - 提出风险防范和应对措施。
5. 实施方案：
   - 制定项目实施的时间计划和阶段目标。
   - 明确资金筹措和使用计划。
   - 提出组织保障和监督管理措施。
6. 结论与建议：
   - 对项目可行性做出总体评价。
   - 提出具体实施建议。

三、语言要求
1. 使用客观、专业的语言，避免主观臆断。
2. 数据准确，论证充分，引用资料注明来源。
3. 专业术语使用规范，必要时提供解释。

四、格式规范
1. 正文段落首行缩进2字符（包括一级标题）。
2. 各级标题使用规范的序号标识。
3. 图表、数据应清晰规范，并标注来源。
4. 落款包括编制单位和日期。
5. 落款下方注明联系人和联系方式，格式为"联系人：XXX，联系电话：XXXXXXXX"。

请确保报告内容全面、客观、专业，论证充分，数据可靠，为决策提供科学依据。`,
    category: 'professional'
  },
  {
    id: 'proposal',
    name: '提案',
    icon: '💡',
    description: '针对某一问题或工作提出意见和建议的文件',
    templatePrompt: `请根据提供的信息撰写一份规范的提案。

一、标题要求
标题应为"关于+建议事项+的提案"格式，居中排布，不使用标点符号。

二、正文结构
1. 提案人信息：
   - 注明提案人姓名、单位、职务等基本信息。
   - 如为集体提案，注明领衔人和附议人。
2. 问题背景：
   - 简要说明提出提案的背景和缘由。
   - 阐述问题的现状和严重性。
   - 引用相关数据和事实支撑问题描述。
3. 问题分析：
   - 深入分析问题产生的原因。
   - 指出现有政策或措施的不足之处。
   - 分析问题对社会发展的影响。
4. 具体建议：
   - 提出明确、具体、可操作的建议。
   - 建议应有针对性，切实可行。
   - 可分条列出，使用"一、二、"等序号。
5. 预期效果：
   - 分析建议实施后可能产生的积极效果。
   - 说明建议对解决问题的作用。

三、语言要求
1. 使用客观、理性的语言，避免情绪化表达。
2. 论述有理有据，建议具有建设性。
3. 表述简明扼要，重点突出。

四、格式规范
1. 正文段落首行缩进2字符（包括一级标题）。
2. 各级标题使用规范的序号标识。
3. 如有附件材料，在正文结束后注明。
4. 落款包括提案人签名和日期。
5. 落款下方注明联系人和联系方式，格式为"联系人：XXX，联系电话：XXXXXXXX"。

请确保提案内容客观真实，问题分析深入，建议具体可行，便于相关部门理解和采纳。`,
    category: 'professional'
  },
  {
    id: 'opinion',
    name: '意见',
    icon: '📣',
    description: '对某项工作提出见解和处理办法的公文',
    templatePrompt: `请根据提供的信息撰写一份规范的意见。

一、标题要求
标题应为"发文单位+关于+事项+的意见"格式，居中排布，不使用标点符号。

二、正文结构
1. 开头部分：
   - 说明制定意见的背景和依据。
   - 可引用上级文件精神或相关政策法规。
   - 阐明制定意见的目的和意义。
2. 主体部分：
   - 分条列出具体意见，使用"一、二、"等序号。
   - 每条意见应明确具体，有针对性。
   - 内容可包括指导思想、基本原则、主要目标、具体措施等。
   - 明确责任分工和工作要求。
3. 结尾部分：
   - 说明意见的执行时限和适用范围。
   - 提出贯彻落实的要求。
   - 必要时明确解释权归属。

三、语言要求
1. 使用规范、严谨的公文语言。
2. 表述准确、明确，避免模糊不清的表达。
3. 语气坚定，体现政策导向性。

四、格式规范
1. 正文段落首行缩进2字符（包括一级标题）。
2. 一级标题使用"一、二、"等序号，二级标题使用"（一）（二）"等序号。
3. 落款右对齐，包括单位名称和日期（XXXX年XX月XX日）。
4. 落款下方注明联系人和联系方式，格式为"联系人：XXX，联系电话：XXXXXXXX"。
4. 如有附件，在正文结束后注明。

请确保意见内容全面、具体、可操作，便于相关单位理解和执行。`,
    category: 'professional'
  },
  {
    id: 'performance',
    name: '述职报告',
    icon: '👨‍💼',
    description: '汇报个人或单位任职期间履行职责情况的报告',
    templatePrompt: `请根据提供的信息撰写一份规范的述职报告。

一、标题要求
标题应为"XX年度述职报告"或"XX单位/职务述职报告"格式，居中排布，不使用标点符号。

二、正文结构
1. 基本情况：
   - 简要介绍个人或单位的基本情况。
   - 说明述职的时间范围和工作岗位。
2. 履职情况：
   - 按照职责分工，系统总结履行岗位职责的情况。
   - 重点介绍主要工作内容和完成情况。
   - 使用具体数据和事例支撑。
3. 工作成绩：
   - 客观总结取得的主要成绩和业绩。
   - 突出重点工作和创新举措。
   - 可分领域或分项目进行总结。
4. 问题不足：
   - 实事求是地分析存在的问题和不足。
   - 深入剖析问题产生的原因。
   - 表明改进的态度和决心。
5. 今后打算：
   - 提出下一步工作思路和计划。
   - 明确改进措施和努力方向。
   - 表达做好工作的信心和决心。

三、语言要求
1. 使用客观、实事求是的语言，避免过度自我评价。
2. 成绩不夸大，问题不回避，态度诚恳。
3. 表述简明扼要，重点突出。

四、格式规范
1. 正文段落首行缩进2字符（包括一级标题）。
2. 各级标题使用规范的序号标识。
3. 落款包括述职人姓名和日期。
4. 落款下方注明联系人和联系方式，格式为"联系人：XXX，联系电话：XXXXXXXX"。

请确保述职报告内容客观真实，重点突出，既总结成绩又分析问题，体现个人或单位的工作特点和成效。`,
    category: 'professional'
  },
  {
    id: 'analysis',
    name: '形势分析报告',
    icon: '📊',
    description: '分析当前形势状况和发展趋势的报告',
    templatePrompt: `请根据提供的信息撰写一份规范的形势分析报告。

一、标题要求
标题应为"关于+领域/行业+形势分析报告"或"XX年度+领域/行业+形势分析报告"格式，居中排布，不使用标点符号。

二、正文结构
1. 总体概述：
   - 概括分析对象的总体形势和特点。
   - 简要说明分析的时间范围和背景。
   - 提出分析的主要维度和关注点。
2. 现状分析：
   - 运用数据和事实，客观分析当前形势。
   - 可从政治、经济、社会、技术等多个维度进行分析。
   - 指出主要特点和关键变化。
3. 问题挑战：
   - 分析当前面临的主要问题和挑战。
   - 深入剖析问题产生的原因和影响。
   - 评估问题的严重程度和紧迫性。
4. 发展趋势：
   - 基于现状和问题，预测未来发展趋势。
   - 分析可能出现的机遇和风险。
   - 预判关键指标的变化方向。
5. 对策建议：
   - 针对问题和趋势，提出具体对策建议。
   - 建议应具有前瞻性、针对性和可操作性。
   - 可分条列出，使用"一、二、"等序号。

三、语言要求
1. 使用客观、专业的语言，避免主观臆断。
2. 数据准确，论证充分，引用资料注明来源。
3. 分析深入，预测合理，建议可行。

四、格式规范
1. 正文段落首行缩进2字符（包括一级标题）。
2. 各级标题使用规范的序号标识。
3. 图表、数据应清晰规范，并标注来源。
4. 落款包括编制单位和日期。
5. 落款下方注明联系人和联系方式，格式为"联系人：XXX，联系电话：XXXXXXXX"。

请确保报告内容全面、客观、专业，分析深入，预测合理，为决策提供参考依据。`,
    category: 'professional'
  },

  // 讲话稿件类型
  {
    id: 'speech',
    name: '讲话稿',
    icon: '🎤',
    description: '领导人在会议或活动上的讲话文稿',
    templatePrompt: `请根据提供的信息撰写一份规范的讲话稿。

一、标题要求
标题应为"在+会议/活动名称+上的讲话"格式，居中排布，不使用标点符号。

二、正文结构
1. 开场白：
   - 称呼：根据场合使用恰当的称呼，如"同志们"、"各位领导、各位来宾"等。
   - 开场语：表达对与会者的问候，简要点明讲话场合和主题。
2. 主体部分：
   - 引言：交代讲话背景和目的，引出主题。
   - 主要内容：按照逻辑顺序展开论述，可分为几个部分：
     * 形势分析：分析当前形势和任务。
     * 工作回顾：总结过去工作成绩和经验。
     * 问题剖析：指出存在的问题和不足。
     * 工作部署：提出下一步工作要求和任务。
   - 每个部分可使用"第一"、"第二"等序号或小标题。
3. 结束语：
   - 总结讲话要点，强调核心观点。
   - 表达期望和信心。
   - 必要时提出号召和鼓励。
   - 结束用语，如"谢谢大家"。

三、语言要求
1. 语言风格：
   - 正式场合：庄重严肃，用词规范。
   - 一般场合：亲切自然，生动活泼。
2. 表达方式：
   - 使用第一人称"我"或"我们"。
   - 语言简洁明了，避免长句和复杂结构。
   - 适当使用排比、比喻等修辞手法增强感染力。
3. 语气：
   - 坚定有力，体现领导风范。
   - 亲切诚恳，拉近与听众距离。

四、格式规范
1. 正文段落首行缩进2字符（包括一级标题）。
2. 讲话稿通常不需要署名和日期。
3. 重要观点可用黑体或加粗字体标出。
4. 适当设置自然段，便于演讲者停顿和换气。

请确保讲话稿内容充实，逻辑清晰，语言生动，既符合讲话者身份特点，又能引起听众共鸣。`,
    category: 'speech'
  },
  {
    id: 'remarks',
    name: '发言稿',
    icon: '🗣️',
    description: '在会议或活动上的发言文稿',
    templatePrompt: `请根据提供的信息撰写一份规范的发言稿。

一、标题要求
标题应为"在+会议/活动名称+上的发言"格式，居中排布，不使用标点符号。

二、正文结构
1. 开场白：
   - 称呼：根据场合使用恰当的称呼，如"各位领导"、"各位同事"等。
   - 开场语：简要表达参会感受或对主办方的感谢。
2. 主体部分：
   - 引言：点明发言主题和目的。
   - 主要内容：围绕主题展开论述，可包括：
     * 情况介绍：介绍相关工作或研究情况。
     * 经验分享：分享成功经验或做法。
     * 问题分析：分析存在的问题和困难。
     * 意见建议：提出个人或单位的意见和建议。
   - 内容应重点突出，条理清晰。
3. 结束语：
   - 总结发言要点。
   - 表达谢意或祝愿。
   - 简短的结束用语，如"谢谢大家"。

三、语言要求
1. 语言风格：
   - 正式场合：用语规范，表述准确。
   - 交流场合：语言亲切，表达生动。
2. 表达方式：
   - 使用第一人称"我"或"我们"。
   - 语言简洁明了，避免冗长。
   - 适当使用生动事例增强说服力。
3. 语气：
   - 诚恳真实，避免空洞说教。
   - 积极向上，富有建设性。

四、格式规范
1. 正文段落首行缩进2字符（包括一级标题）。
2. 发言稿通常不需要署名和日期。
3. 适当设置自然段，便于发言者停顿和换气。
4. 发言时间控制在规定范围内，一般不超过15分钟。

请确保发言稿内容充实，观点鲜明，语言得体，既能表达个人或单位立场，又能引起听众共鸣。`,
    category: 'speech'
  },
  {
    id: 'party-study',
    name: '党建学习分享',
    icon: '📚',
    description: '学习习总书记重要讲话，结合工作实际谈心得体会',
    templatePrompt: `请根据以下信息撰写一份党建学习分享发言稿，包括：
1. 开场：表明学习主题和重要意义
2. 主要内容：
   - 重要讲话的核心要义和精神实质
   - 对讲话精神的深刻理解和思考
   - 结合本职工作的具体实践和体会
   - 下一步工作思路和改进措施
3. 结束语：表达继续深入学习和践行的决心
语言要求：政治性强、思想深刻、联系实际、富有感染力。`,
    category: 'speech'
  },
  {
    id: 'ceremony-speech',
    name: '仪式致辞',
    icon: '🏆',
    description: '为各类仪式、庆典场合准备的致辞稿',
    templatePrompt: `请根据以下信息撰写一份仪式致辞，包括开场白、主体内容（对活动意义的阐述、对相关人员的感谢等）和结束语。语言要求庄重、热情、简洁有力。`,
    category: 'speech'
  },
  {
    id: 'conference-speech',
    name: '会议发言稿',
    icon: '👥',
    description: '为各类会议发言准备的文稿',
    templatePrompt: `请根据以下信息撰写一份会议发言稿，包括开场白、主体内容（对相关工作的汇报、经验交流或意见建议等）和结束语。语言要求简明扼要、重点突出。`,
    category: 'speech'
  },
  {
    id: 'inspection-speech',
    name: '调研讲话稿',
    icon: '🔍',
    description: '领导在调研考察过程中的讲话文稿',
    templatePrompt: `请根据以下信息撰写一份调研讲话稿，包括开场白、主体内容（调研感受、肯定成绩、指出问题、提出要求等）和结束语。语言要求亲切自然、有针对性。`,
    category: 'speech'
  },
  {
    id: 'welcome-speech',
    name: '欢迎词',
    icon: '🤝',
    description: '欢迎来宾、客人的讲话稿',
    templatePrompt: `请根据以下信息撰写一份欢迎词，包括问候语、欢迎内容、活动或会晤意义、祝愿等部分。语言要求热情友好、礼节性强、简明扼要。`,
    category: 'speech'
  },
  {
    id: 'election-speech',
    name: '竞选演讲稿',
    icon: '📣',
    description: '参加选举或竞聘的演讲稿',
    templatePrompt: `请根据以下信息撰写一份竞选演讲稿，包括自我介绍、能力展示、工作设想、郑重承诺等部分。语言要求真诚、有感染力、有说服力。`,
    category: 'speech'
  },
  {
    id: 'theme-speech',
    name: '主题演讲稿',
    icon: '🎯',
    description: '围绕特定主题的演讲稿',
    templatePrompt: `请根据以下信息撰写一份主题演讲稿，包括开场引入、主题阐述、案例分析、结论启示等部分。语言要求生动、有深度、有内涵。`,
    category: 'speech'
  },

  // 规章制度类型
  {
    id: 'regulation',
    name: '规章制度',
    icon: '📜',
    description: '规范组织内部运行和管理的制度性文件',
    templatePrompt: `请根据提供的信息撰写一份规范的规章制度。

一、标题要求
  标题应为"XX单位+XX规章制度"或"关于XX的规章制度"格式，居中排布，不使用标点符号。

二、正文结构
  1. 总则部分：
     - 制定目的：说明制定本制度的目的和意义。
     - 依据：列明制定本制度所依据的上级文件或法律法规。
     - 适用范围：明确本制度适用的对象和范围。
     - 基本原则：阐述贯彻执行本制度应遵循的基本原则。
  2. 主体部分：
     - 具体规定：按照不同方面或内容分条列出具体规定。
     - 职责分工：明确各部门、各岗位的职责和分工。
     - 工作流程：规定相关工作的操作流程和标准。
     - 奖惩措施：明确奖励和处罚的具体规定。
  3. 附则部分：
     - 解释权归属：说明本制度的解释权归属。
     - 实施时间：明确本制度的实施时间。
     - 与其他制度的关系：说明与其他相关制度的关系。

三、语言要求
  1. 使用规范、严谨的公文语言。
  2. 表述准确、明确，避免模糊不清的表达。
  3. 使用祈使句和规定性语言，如"应当""必须""严禁"等。
  4. 条款之间逻辑关系清晰，前后一致。

四、格式规范
  1. 正文段落首行缩进2字符（包括一级标题）。
  2. 一级条款使用"第一条、第二条"等序号，二级条款使用"（一）（二）"等序号。
  3. 各条款应当简明扼要，一事一则。
  4. 落款包括制定单位和日期，右对齐。
  5. 落款下方注明联系人和联系方式，格式为"联系人：XXX，联系电话：XXXXXXXX"。

请确保制度内容全面、具体、可操作，便于执行和监督。`,
    category: 'official'
  },
  {
    id: 'measure',
    name: '实施办法',
    icon: '📋',
    description: '为贯彻执行某项工作而制定的具体措施',
    templatePrompt: `请根据提供的信息撰写一份规范的实施办法。

一、标题要求
  标题应为"XX单位+XX实施办法"或"关于XX的实施办法"格式，居中排布，不使用标点符号。

二、正文结构
  1. 总则部分：
     - 制定目的：说明制定本办法的目的和意义。
     - 依据：列明制定本办法所依据的上级文件或法律法规。
     - 适用范围：明确本办法适用的对象和范围。
     - 指导思想：阐述贯彻执行本办法的指导思想和原则。
  2. 主体部分：
     - 实施内容：详细说明实施的具体内容和要求。
     - 实施步骤：按照时间顺序或逻辑顺序列出实施步骤。
     - 组织保障：明确组织领导、人员配备、经费保障等措施。
     - 工作要求：提出对实施工作的具体要求和标准。
  3. 附则部分：
     - 实施时间：明确本办法的实施时间。
     - 解释权归属：说明本办法的解释权归属。
     - 其他事项：说明其他需要说明的事项。

三、语言要求
  1. 使用规范、严谨的公文语言。
  2. 表述准确、具体，避免模糊不清的表达。
  3. 使用指令性、操作性强的语言，便于执行。
  4. 条款之间逻辑关系清晰，前后一致。

四、格式规范
  1. 正文段落首行缩进2字符（包括一级标题）。
  2. 一级条款使用"第一条、第二条"等序号，二级条款使用"（一）（二）"等序号。
  3. 各条款应当简明扼要，一事一则。
  4. 落款包括制定单位和日期，右对齐。
  5. 落款下方注明联系人和联系方式，格式为"联系人：XXX，联系电话：XXXXXXXX"。

请确保办法内容具体、可行、可操作，便于基层单位理解和执行。`,
    category: 'official'
  },
  {
    id: 'rule',
    name: '管理办法',
    icon: '⚖',
    description: '对某一领域或事项进行规范管理的制度性文件',
    templatePrompt: `请根据提供的信息撰写一份规范的管理办法。

一、标题要求
  标题应为"XX单位+XX管理办法"或"XX管理办法"格式，居中排布，不使用标点符号。

二、正文结构
  1. 总则部分：
     - 制定目的：说明制定本办法的目的和意义。
     - 依据：列明制定本办法所依据的上级文件或法律法规。
     - 适用范围：明确本办法适用的对象和范围。
     - 管理原则：阐述管理工作应遵循的基本原则。
  2. 主体部分：
     - 管理内容：详细说明管理的具体内容和要求。
     - 管理职责：明确各部门、各岗位在管理工作中的职责。
     - 管理程序：规定管理工作的操作程序和流程。
     - 监督检查：明确监督检查的方式、内容和要求。
     - 奖惩措施：规定奖励和处罚的具体内容和标准。
  3. 附则部分：
     - 实施时间：明确本办法的实施时间。
     - 解释权归属：说明本办法的解释权归属。
     - 与其他规定的关系：说明与其他相关规定的关系。

三、语言要求
  1. 使用规范、严谨的公文语言。
  2. 表述准确、明确，避免模糊不清的表达。
  3. 使用规定性、指令性语言，如"应当""必须""严禁"等。
  4. 条款之间逻辑关系清晰，前后一致。

四、格式规范
  1. 正文段落首行缩进2字符（包括一级标题）。
  2. 一级条款使用"第一条、第二条"等序号，二级条款使用"（一）（二）"等序号。
  3. 各条款应当简明扼要，一事一则。
  4. 落款包括制定单位和日期，右对齐。
  5. 落款下方注明联系人和联系方式，格式为"联系人：XXX，联系电话：XXXXXXXX"。

请确保管理办法内容全面、具体、可操作，便于执行和监督。`,
    category: 'official'
  },
  {
    id: 'procedure',
    name: '工作流程',
    icon: '🔄',
    description: '规范工作步骤和操作规范的文件',
    templatePrompt: `请根据提供的信息撰写一份规范的工作流程。

一、标题要求
  标题应为"XX工作流程"或"XX业务操作流程"格式，居中排布，不使用标点符号。

二、正文结构
  1. 流程概述：
     - 流程目的：说明制定本流程的目的和意义。
     - 适用范围：明确本流程适用的业务范围和对象。
     - 流程概览：简要概述整个流程的主要环节和步骤。
  2. 详细步骤：
     - 按照时间顺序或逻辑顺序详细列出各个步骤。
     - 每个步骤应包含：
       * 步骤名称：明确标识每个步骤。
       * 操作内容：详细说明该步骤的具体操作内容。
       * 责任主体：明确该步骤的责任部门或责任人。
       * 操作要点：提示操作中需要注意的关键点。
       * 所需材料：列出该步骤所需的材料或文件。
       * 时限要求：明确该步骤的完成时限。
  3. 流程图：
     - 使用流程图直观展示整个工作流程。
     - 流程图应标明各环节的顺序、关系和责任主体。
  4. 注意事项：
     - 列出执行流程中需要特别注意的事项。
     - 提示可能出现的问题及解决方法。
  5. 相关文件：
     - 列出与本流程相关的表格、文件和参考资料。

三、语言要求
  1. 使用简明、准确的语言，避免冗长复杂的表述。
  2. 使用指令性、操作性强的语言，便于执行。
  3. 专业术语使用规范，必要时提供解释。
  4. 步骤描述具体明确，避免模糊表达。

四、格式规范
  1. 正文段落首行缩进2字符（包括一级标题）。
  2. 步骤序号使用"1、2、3"或"步骤一、步骤二"等标识。
  3. 重要内容可用黑体或加粗字体标出。
  4. 流程图应清晰、规范，使用统一的图形符号。
  5. 落款包括制定单位和日期，右对齐。
  6. 落款下方注明联系人和联系方式，格式为"联系人：XXX，联系电话：XXXXXXXX"。

请确保工作流程内容具体、清晰、可操作，便于相关人员理解和执行。`,
    category: 'official'
  },
  {
    id: 'standard',
    name: '工作标准',
    icon: '📏',
    description: '明确工作要求和评价标准的规范性文件',
    templatePrompt: `请根据提供的信息撰写一份规范的工作标准。

一、标题要求
  标题应为"XX工作标准"或"XX岗位工作标准"格式，居中排布，不使用标点符号。

二、正文结构
  1. 标准概述：
     - 制定目的：说明制定本标准的目的和意义。
     - 适用范围：明确本标准适用的工作范围和对象。
     - 基本原则：阐述制定和执行标准应遵循的基本原则。
  2. 标准内容：
     - 质量标准：明确工作质量的具体要求和标准。
       * 准确性要求：对工作准确性的具体要求。
       * 完整性要求：对工作完整性的具体要求。
       * 规范性要求：对工作规范性的具体要求。
     - 时间标准：明确工作时间的具体要求和标准。
       * 完成时限：对工作完成时间的具体要求。
       * 响应速度：对工作响应速度的具体要求。
       * 处理效率：对工作处理效率的具体要求。
     - 流程标准：明确工作流程的具体要求和标准。
       * 操作步骤：对工作操作步骤的具体要求。
       * 流程规范：对工作流程规范的具体要求。
       * 协作配合：对工作协作配合的具体要求。
     - 服务标准：明确服务态度和方式的具体要求和标准。
  3. 评价方法：
     - 评价指标：列出评价工作的具体指标。
     - 评价方式：说明评价工作的具体方式和方法。
     - 评价周期：明确评价工作的周期和时间。
     - 评价结果应用：说明评价结果的应用和反馈。

三、语言要求
  1. 使用客观、准确的语言，避免主观臆断。
  2. 表述具体、量化，便于考核和评价。
  3. 使用规范的专业术语，确保表述准确。
  4. 标准描述清晰明确，避免模糊表达。

四、格式规范
  1. 正文段落首行缩进2字符（包括一级标题）。
  2. 各级标题使用规范的序号标识。
  3. 量化指标应明确标出单位和数值。
  4. 落款包括制定单位和日期，右对齐。
  5. 落款下方注明联系人和联系方式，格式为"联系人：XXX，联系电话：XXXXXXXX"。

请确保工作标准内容具体、量化、可考核，便于相关人员理解和执行，也便于管理者进行评价和考核。`,
    category: 'official'
  },
  {
    id: 'initiative',
    name: '倡议书',
    icon: '📣',
    description: '向社会公开发出倡议的文书',
    templatePrompt: `请根据提供的信息撰写一份规范的倡议书。

一、标题要求
标题应为"关于+倡议事项+的倡议书"格式，居中排布，不使用标点符号。

二、正文结构
1. 开头部分：
   - 称呼：根据倡议对象使用恰当的称呼，如"亲爱的市民朋友们"、"尊敬的广大师生"等。
   - 引言：简要说明发起倡议的背景和意义。
2. 主体部分：
   - 现状分析：分析当前存在的问题或面临的形势。
   - 倡议内容：明确提出具体倡议事项，可分条列出。
   - 倡议理由：说明倡议的必要性和意义。
   - 预期效果：阐述响应倡议可能带来的积极影响。
3. 结束部分：
   - 号召语：呼吁大家积极响应倡议。
   - 表达期望：对倡议活动的美好愿景。
   - 感谢语：对响应倡议者表示感谢。

三、语言要求
1. 语言风格：
   - 热情诚恳，富有感染力。
   - 积极向上，充满正能量。
2. 表达方式：
   - 使用"我们"等第一人称，增强亲近感。
   - 语言简洁明了，通俗易懂。
   - 适当使用号召性、感染性强的词语。
3. 语气：
   - 诚恳真挚，不强制命令。
   - 热情洋溢，富有感染力。

四、格式规范
1. 正文段落首行缩进2字符（包括一级标题）。
2. 倡议内容可用序号标识，便于阅读。
3. 落款包括倡议发起单位或个人和日期。
4. 落款下方注明联系人和联系方式，格式为"联系人：XXX，联系电话：XXXXXXXX"。
5. 必要时可附上响应方式和联系方式。

请确保倡议书内容积极向上，倡议明确具体，语言感染力强，能够引起广泛共鸣和积极响应。`,
    category: 'official'
  },
  {
    id: 'praise',
    name: '表扬信',
    icon: '👏',
    description: '对个人或集体的优秀表现予以肯定的信函',
    templatePrompt: `请根据提供的信息撰写一份规范的表扬信。

一、标题要求
标题应为"表扬信"或"关于表扬XX的信"格式，居中排布，不使用标点符号。

二、正文结构
1. 开头部分：
   - 称呼：根据收信对象使用恰当的称呼，如"尊敬的XX单位"、"亲爱的XX同志"等。
   - 开场语：简要说明写信目的，表达感谢和赞赏之情。
2. 主体部分：
   - 事实叙述：客观描述被表扬对象的优秀表现和突出贡献。
   - 具体事例：列举具体事例，用事实说话。
   - 影响评价：说明其行为产生的积极影响和社会价值。
   - 精神点评：提炼其行为体现的精神品质和价值观念。
3. 结束部分：
   - 再次表达感谢和赞赏。
   - 提出希望或祝愿。
   - 结束语，如"此致"、"敬礼"等。

三、语言要求
1. 语言风格：
   - 真诚热情，不做作不夸张。
   - 具体生动，避免空洞说教。
2. 表达方式：
   - 使用第一人称"我"或"我们"。
   - 语言简洁明了，重点突出。
   - 适当使用褒义词和赞美性词语。
3. 语气：
   - 诚恳真挚，发自内心。
   - 热情洋溢，充满敬意。

四、格式规范
1. 正文段落首行缩进2字符（包括一级标题）。
2. 落款右对齐，包括发信单位或个人和日期。
3. 落款下方注明联系人和联系方式，格式为"联系人：XXX，联系电话：XXXXXXXX"。
4. 如有需要，可加盖公章。
5. 必要时可附上联系方式。

请确保表扬信内容真实具体，表扬有据，语言真诚热情，既能肯定对方的贡献，又能起到激励和引导作用。`,
    category: 'official'
  },
  {
    id: 'condolence',
    name: '慰问信',
    icon: '💌',
    description: '对遭遇困难或特殊情况的个人或集体表达关怀的信函',
    templatePrompt: `请根据提供的信息撰写一份规范的慰问信。

一、标题要求
标题应为"慰问信"或"致XX的慰问信"格式，居中排布，不使用标点符号。

二、正文结构
1. 开头部分：
   - 称呼：根据收信对象使用恰当的称呼，如"亲爱的XX同志"、"尊敬的XX家属"等。
   - 开场语：表达关心和慰问之情。
2. 主体部分：
   - 情况了解：表明已了解对方的困难或特殊情况。
   - 同情关怀：表达对对方处境的理解和同情。
   - 肯定鼓励：肯定对方的努力和坚强，给予精神鼓励。
   - 支持帮助：表达提供帮助和支持的意愿。
3. 结束部分：
   - 美好祝愿：表达对未来的美好祝愿。
   - 再次表达慰问和关怀。
   - 结束语，如"此致"、"敬礼"等。

三、语言要求
1. 语言风格：
   - 温暖亲切，充满人文关怀。
   - 真诚恳切，不做作不夸张。
2. 表达方式：
   - 使用第一人称"我"或"我们"。
   - 语言简洁明了，避免过于冗长。
   - 适当使用温暖、关怀类词语。
3. 语气：
   - 诚恳真挚，发自内心。
   - 温和亲切，充满关爱。

四、格式规范
1. 正文段落首行缩进2字符（包括一级标题）。
2. 落款右对齐，包括发信单位或个人和日期。
3. 落款下方注明联系人和联系方式，格式为"联系人：XXX，联系电话：XXXXXXXX"。
4. 如有需要，可加盖公章。
5. 必要时可附上联系方式或具体帮助措施。

请确保慰问信内容真诚温暖，语言亲切感人，既能表达真挚的关怀，又能给予对方精神上的支持和鼓励。`,
    category: 'official'
  },
  {
    id: 'notification',
    name: '通报',
    icon: '📢',
    description: '表彰先进或批评错误的公文',
    templatePrompt: `请根据提供的信息撰写一份规范的通报。

一、标题要求
标题应为"发文单位+关于+通报事项+的通报"格式，居中排布，不使用标点符号。

二、正文结构
1. 开头部分：
   - 简要说明通报的主要内容和目的。
   - 可引用相关政策文件或工作要求。
2. 事实陈述：
   - 客观叙述通报事项的基本情况。
   - 表彰通报：介绍先进典型的主要事迹和突出贡献。
   - 批评通报：说明问题或错误的具体表现和危害。
   - 使用具体数据和事例支撑。
3. 评价分析：
   - 表彰通报：分析先进典型的经验和做法，总结其推广价值。
   - 批评通报：分析问题产生的原因，指出教训和应吸取的经验。
4. 工作要求：
   - 提出下一步工作的具体要求和措施。
   - 表彰通报：号召学习先进，推广经验。
   - 批评通报：要求整改问题，防止类似情况再次发生。
5. 结尾部分：
   - 表达对做好相关工作的期望。
   - 必要时说明通报的范围和要求。

三、语言要求
1. 使用客观、公正的语言。
2. 表彰通报：语气积极向上，充分肯定成绩。
3. 批评通报：语气严肃认真，实事求是，不夸大或缩小问题。

四、格式规范
1. 正文段落首行缩进2字符（包括一级标题）。
2. 各级标题使用规范的序号标识。
3. 落款右对齐，包括单位名称和日期（XXXX年XX月XX日）。
4. 落款下方注明联系人和联系方式，格式为"联系人：XXX，联系电话：XXXXXXXX"。
5. 如有附件，在正文结束后注明。

请确保通报内容客观真实，事实清楚，评价恰当，要求明确，起到表彰先进或警示教育的作用。`,
    category: 'professional'
  },
  {
    id: 'briefing',
    name: '简报',
    icon: '📰',
    description: '简要报告工作情况和动态信息的报告',
    templatePrompt: `请根据提供的信息撰写一份规范的简报。

一、标题要求
标题应为"XX简报"或"关于XX情况的简报"格式，居中排布，不使用标点符号。可在标题下方注明期数（第XX期）。

二、正文结构
1. 导语部分：
   - 概括简报的主要内容和要点。
   - 简明扼要，一般不超过100字。
   - 可使用小标题或加粗字体突出。
2. 主体部分：
   - 按照重要性或时间顺序，分条目报道主要情况和信息。
   - 每个条目可设置小标题，使用【】或【】等符号标识。
   - 内容简明扼要，突出重点，避免冗长叙述。
   - 使用具体数据和事例支撑报道内容。
3. 背景链接：
   - 必要时可提供相关背景信息或事件前因后果。
   - 背景信息应简洁，不喧宾夺主。
4. 结语部分：
   - 可对报道内容进行简要总结或展望。
   - 不是必须的，可根据需要选择是否添加。

三、语言要求
1. 使用简洁、准确、生动的语言。
2. 文字精炼，避免空话、套话。
3. 数据准确，事实清晰。

四、格式规范
1. 正文段落首行缩进2字符（包括一级标题）。
2. 条目之间可用分隔线或空行分开。
3. 重要信息可用黑体或加粗字体标出。
4. 落款包括编发单位和日期。
5. 落款下方注明联系人和联系方式，格式为"联系人：XXX，联系电话：XXXXXXXX"。

请确保简报内容真实准确，重点突出，文字精炼，便于上级和相关部门及时了解情况。`,
    category: 'professional'
  },
  {
    id: 'thanks',
    name: '感谢信',
    icon: '💌',
    description: '表达感谢之情的正式信函',
    templatePrompt: `请根据提供的信息撰写一份规范的感谢信。

一、标题要求
标题应为"感谢信"或"致XX的感谢信"格式，居中排布，不使用标点符号。

二、正文结构
1. 开头部分：
   - 称呼：根据收信对象使用恰当的称呼，如"尊敬的XX单位"、"亲爱的XX同志"等。
   - 开场语：简要表达感谢之情，点明感谢事由。
2. 主体部分：
   - 事实叙述：具体描述对方提供的帮助或支持。
   - 影响评价：说明对方帮助带来的积极影响和意义。
   - 感受表达：表达自己或单位的真挚感受和感激之情。
   - 具体事例：可列举具体事例，增强真实感和感染力。
3. 结束部分：
   - 再次表达感谢之情。
   - 表达美好祝愿。
   - 结束语，如"此致"、"敬礼"等。

三、语言要求
1. 语言风格：
   - 真诚热情，不做作不夸张。
   - 具体生动，避免空洞套话。
2. 表达方式：
   - 使用第一人称"我"或"我们"。
   - 语言简洁明了，重点突出。
   - 适当使用感谢性、赞美性词语。
3. 语气：
   - 诚恳真挚，发自内心。
   - 热情洋溢，充满敬意。

四、格式规范
1. 正文段落首行缩进2字符（包括一级标题）。
2. 落款右对齐，包括发信单位或个人和日期。
3. 落款下方注明联系人和联系方式，格式为"联系人：XXX，联系电话：XXXXXXXX"。
4. 如有需要，可加盖公章。
5. 必要时可附上联系方式。

请确保感谢信内容真实具体，感情真挚，语言得体，既能表达真诚的谢意，又能维护良好的关系。`,
    category: 'official'
  },
  {
    id: 'invitation',
    name: '邀请函',
    icon: '🎟️',
    description: '邀请参加活动或会议的正式函件',
    templatePrompt: `请根据提供的信息撰写一份规范的邀请函。

一、标题要求
标题应为"邀请函"或"XX活动邀请函"格式，居中排布，不使用标点符号。

二、正文结构
1. 开头部分：
   - 称呼：根据被邀请对象使用恰当的称呼，如"尊敬的XX先生/女士"、"亲爱的XX同志"等。
   - 开场语：表达邀请之意，简要说明邀请事由。
2. 主体部分：
   - 活动介绍：简要介绍活动背景、目的和意义。
   - 邀请内容：明确说明邀请对方参加的具体事项。
   - 时间地点：详细说明活动的时间、地点和日程安排。
   - 其他事项：说明需要注意的事项，如着装要求、报名方式等。
3. 结束部分：
   - 期待语：表达期待对方参加的心情。
   - 联系方式：提供联系人姓名、电话、邮箱等联系方式。
   - 回复要求：说明是否需要回复及回复截止日期。
   - 结束语，如"此致"、"敬礼"等。

三、语言要求
1. 语言风格：
   - 礼貌得体，热情诚恳。
   - 简明扼要，重点突出。
2. 表达方式：
   - 使用第一人称"我们"表示邀请方。
   - 使用敬语表达对被邀请者的尊重。
   - 时间、地点等信息表述准确无误。
3. 语气：
   - 热情但不过分热情，保持适度。
   - 正式但不生硬，保持亲切感。

四、格式规范
1. 正文段落首行缩进2字符（包括一级标题）。
2. 落款右对齐，包括邀请单位或个人和日期。
3. 落款下方注明联系人和联系方式，格式为"联系人：XXX，联系电话：XXXXXXXX"。
4. 如有需要，可加盖公章。
5. 可附上回执单，便于被邀请者回复。

请确保邀请函内容清晰明确，信息完整准确，语言礼貌得体，既能表达诚挚的邀请，又能提供必要的信息。`,
    category: 'official'
  },
  {
    id: 'congratulation',
    name: '贺信',
    icon: '🎉',
    description: '对重要成就、纪念日或喜事表示祝贺的信函',
    templatePrompt: `请根据提供的信息撰写一份规范的贺信。

一、标题要求
标题应为"贺信"或"致XX的贺信"格式，居中排布，不使用标点符号。

二、正文结构
1. 开头部分：
   - 称呼：根据收信对象使用恰当的称呼，如"尊敬的XX单位"、"亲爱的XX同志"等。
   - 开场语：表达祝贺之意，点明祝贺事由。
2. 主体部分：
   - 事实叙述：简要叙述值得祝贺的事项或成就。
   - 成就评价：肯定对方取得的成就和贡献。
   - 意义阐述：阐述这一成就或喜事的重要意义。
   - 情感表达：表达由衷的祝贺和敬意。
3. 结束部分：
   - 美好祝愿：表达对未来的美好祝愿和期望。
   - 再次表达祝贺之情。
   - 结束语，如"此致"、"敬礼"等。

三、语言要求
1. 语言风格：
   - 热情洋溢，充满喜悦之情。
   - 庄重得体，符合场合和身份。
2. 表达方式：
   - 使用第一人称"我"或"我们"。
   - 语言简洁明了，重点突出。
   - 适当使用祝贺性、赞美性词语。
3. 语气：
   - 诚挚热烈，发自内心。
   - 庄重而不失亲切。

四、格式规范
1. 正文段落首行缩进2字符（包括一级标题）。
2. 落款右对齐，包括发信单位或个人和日期。
3. 落款下方注明联系人和联系方式，格式为"联系人：XXX，联系电话：XXXXXXXX"。
4. 如有需要，可加盖公章。
5. 必要时可附上礼品清单或其他附件。

请确保贺信内容真实具体，情感真挚，语言得体，既能表达真诚的祝贺，又能体现对对方的尊重和重视。`,
    category: 'official'
  },
  {
    id: 'condolence_telegram',
    name: '慰问电',
    icon: '📟',
    description: '对遭遇灾害或困难的地区或单位表达慰问的电文',
    templatePrompt: `请根据提供的信息撰写一份规范的慰问电。

一、标题要求
标题应为"慰问电"或"致XX的慰问电"格式，居中排布，不使用标点符号。

二、正文结构
1. 开头部分：
   - 称呼：根据收电对象使用恰当的称呼，如"XX省人民政府"、"XX灾区人民"等。
   - 开场语：直接表达慰问之情，点明慰问事由。
2. 主体部分：
   - 情况了解：表明已了解对方遭遇的灾害或困难情况。
   - 同情关怀：表达对受灾群众或遇难者的深切同情。
   - 肯定鼓励：肯定对方在困难面前的坚强和努力。
   - 支持帮助：表达提供帮助和支持的意愿或具体措施。
3. 结束部分：
   - 信心鼓励：表达对战胜困难的信心。
   - 美好祝愿：表达对未来重建的美好祝愿。
   - 结束语，简短有力。

三、语言要求
1. 语言风格：
   - 简明扼要，言简意赅。
   - 真挚诚恳，充满关怀。
2. 表达方式：
   - 使用第一人称"我"或"我们"。
   - 语言简洁有力，避免冗长。
   - 适当使用关怀、鼓励类词语。
3. 语气：
   - 诚挚关切，发自内心。
   - 坚定有力，传递信心。

四、格式规范
1. 正文段落首行缩进2字符（包括一级标题）。
2. 落款右对齐，包括发电单位或个人和日期。
3. 落款下方注明联系人和联系方式，格式为"联系人：XXX，联系电话：XXXXXXXX"。
4. 如有需要，可加盖公章。

请确保慰问电内容简明扼要，情感真挚，语言有力，既能表达真诚的慰问和关怀，又能给予对方精神上的支持和鼓励。`,
    category: 'official'
  },
  {
    id: 'reply',
    name: '答复函',
    icon: '✉️',
    description: '对来信、请示或咨询事项作出答复的公文',
    templatePrompt: `请根据提供的信息撰写一份规范的答复函。

一、标题要求
标题应为"关于+答复事项+的答复"格式，居中排布，不使用标点符号。

二、正文结构
1. 开头部分：
   - 称呼：根据收信对象使用恰当的称呼，如"XX单位"、"XX先生/女士"等。
   - 开场语：简要说明收到来函/请示/咨询的时间和内容。
2. 主体部分：
   - 答复内容：明确、具体地回答对方提出的问题或请求。
   - 政策依据：引用相关法律法规或政策作为答复的依据。
   - 解释说明：必要时对答复内容进行解释和说明。
   - 建议措施：如有必要，可提出相关建议或解决方案。
3. 结束部分：
   - 表达合作意愿：表示愿意继续提供帮助或合作。
   - 联系方式：提供进一步咨询的联系人和联系方式。
   - 结束语，如"此复"、"特此答复"等。

三、语言要求
1. 语言风格：
   - 客观准确，实事求是。
   - 清晰明了，避免模糊表述。
2. 表达方式：
   - 使用第一人称"我们"或单位名称。
   - 语言简洁明了，直接回应问题。
   - 避免使用过于专业或难懂的术语。
3. 语气：
   - 公正客观，不偏不倚。
   - 礼貌得体，尊重对方。

四、格式规范
1. 正文段落首行缩进2字符（包括一级标题）。
2. 落款右对齐，包括答复单位和日期。
3. 落款下方注明联系人和联系方式，格式为"联系人：XXX，联系电话：XXXXXXXX"。
4. 如有附件，在正文结束后注明。

请确保答复函内容准确无误，回应明确，语言得体，既能清晰回答对方的问题，又能体现单位的专业和负责任态度。`,
    category: 'official'
  }
];

// 格式化提示词函数
export function formatPrompt(docType: DocumentType, context: DocumentContext, style: StylePreference): string {
  // 基础提示语
  let prompt = docType.templatePrompt;

  // 添加公文格式规范要求
  const formatRequirements = `

同时，请严格遵循以下政府公文写作规范：

1. 内容完整性：
- 每个部分都应该用规范的段落进行充分展开，不要使用简单的要点列举
- 详细说明政策背景、具体措施、实施方式和预期效果
- 对每项政策要点进行详实的论述和必要的解释说明

2. 语言规范性：
- 使用正式的公文语言，采用完整的句式结构
- 避免使用简略语言或口语化表达
- 每个观点都要有完整的论述和必要的解释说明
- 使用规范的政策用语和专业术语

3. 格式规范性：
- 标题使用规范的公文标题格式
- 正文段落保持首行缩进
- 各级标题使用规范的层次标号
- 结构分明，层次清晰

4. 逻辑严谨性：
- 各部分之间要有合理的过渡和衔接
- 论述要有充分的依据和说明
- 政策措施要具有可操作性
- 结构要完整，首尾呼应

请确保生成的内容符合政府公文的严谨性和规范性要求，避免过于简单或概括性的表述。每个政策点都需要有充分的解释和具体的实施指导。`;

  prompt += formatRequirements;

  // 添加上下文信息
  if (context.subject) {
    prompt += `\n\n文件主题：${context.subject}`;
  }
  if (context.recipients) {
    prompt += `\n主送机关：${context.recipients}`;
  }
  if (context.keywords && context.keywords.length > 0) {
    prompt += `\n关键词：${context.keywords.join('、')}`;
  }
  if (context.specialRequirements) {
    prompt += `\n特殊要求：${context.specialRequirements}`;
  }
  if (context.background) {
    prompt += `\n背景信息：${context.background}`;
  }

  // 添加风格偏好
  if (style) {
    prompt += '\n\n风格要求：';
    prompt += `\n- 正式程度：${style.formalityLevel}级（1-5级）`;
    if (style.toneStyle) {
      prompt += `\n- 语言风格：${style.toneStyle}`;
    }
    if (style.detailLevel) {
      prompt += `\n- 详细程度：${style.detailLevel}级（1-5级）`;
    }
    if (style.structurePreference) {
      prompt += `\n- 结构偏好：${style.structurePreference}`;
    }
  }

  return prompt;
}